
# -*- coding: utf-8 -*-

from time import sleep
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

def main():

	# Your Facebook account user and password
	usr = ""
	pwd = ""
	message = "Checkout an amazing selenium script for posting in Facebook Groups!\nhttps://github.com/lalongooo/selenium-fb-group-poster"
	sleep_timer = 5

	#image code is broken with new facebook posting dialog.
	#attach_image = False
	#image_path = "path to image here"

	# Your Facebook Groups links.
	# IMPORTANT: You must be a member of the group, being ADMIN nor required.
	group_links = ["https://www.facebook.com/groups/ayearofrunning/"]

		

	profile = webdriver.FirefoxProfile()
	profile.set_preference("dom.webnotifications.enabled", False)
	profile.set_preference("browser.cache.disk.enable", False)
	profile.set_preference("browser.cache.memory.enable", False)
	profile.set_preference("browser.cache.offline.enable", False)
	profile.set_preference("network.http.use-cache", False)

	driver = webdriver.Firefox(profile)
	driver.implicitly_wait(sleep_timer) # seconds

	# Login to Facebook
	driver.get("http://www.facebook.org")
	driver.find_element_by_id("email").send_keys(usr)
	driver.find_element_by_id("pass").send_keys(pwd)
	driver.find_element_by_css_selector("[value='Log In']").click()
	driver.implicitly_wait(sleep_timer)

	for group in group_links:

		# Go to the Facebook Group
		driver.get(group)
		sleep(sleep_timer)

		# Click the post box
		post_box=driver.find_element_by_xpath("//*[@name='xhpc_message_text']")
		sleep(sleep_timer)

		# Enter the text we want to post to Facebook
		post_box.send_keys(message)
		sleep(sleep_timer)

		#if attach_image:
			# Click on the add media button
			#driver.find_element_by_id("js_24q").click()

			# Provide picture file path
			#driver.find_element_by_xpath("//div[text()='Upload Photos/Video']/following-sibling::div/input").send_keys(image_path)

		# Get the 'Post' button and click on it
		post_button = driver.find_element_by_xpath("//*[@data-testid='react-composer-post-button']").click()
		sleep(sleep_timer)

	# driver.close()

if __name__ == '__main__':
  main()
